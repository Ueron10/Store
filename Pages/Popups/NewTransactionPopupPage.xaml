<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="StoreProgram.Pages.Popups.NewTransactionPopupPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             BackgroundColor="#80000000"
             Padding="24">

    <Grid RowDefinitions="*" ColumnDefinitions="*">
        <Frame Padding="18"
               BackgroundColor="{StaticResource CardBackground}"
               CornerRadius="16"
               HasShadow="True"
               VerticalOptions="Center"
               HorizontalOptions="Center"
               WidthRequest="540">

            <ScrollView>
                <VerticalStackLayout Spacing="12">
                    <Label Text="ðŸ›’ Transaksi Baru"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="{StaticResource TextPrimary}" />

                    <VerticalStackLayout Spacing="6">
                        <Label Text="Pilih Produk" FontAttributes="Bold" TextColor="{StaticResource TextPrimary}"/>
                        <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="10,0" HasShadow="False">
                            <Grid ColumnDefinitions="*,Auto" ColumnSpacing="8" VerticalOptions="Center">
                                <Entry x:Name="SelectedProductEntry"
                                       Placeholder="Pilih produk..."
                                       IsReadOnly="True"
                                       BackgroundColor="Transparent"
                                       TextColor="{StaticResource TextPrimary}" />
                                <Button Grid.Column="1"
                                        Text="Cari"
                                        BackgroundColor="{StaticResource Gray200}"
                                        TextColor="{StaticResource TextPrimary}"
                                        CornerRadius="10"
                                        HeightRequest="36"
                                        Clicked="OnSelectProductClicked" />
                            </Grid>
                        </Frame>
                    </VerticalStackLayout>

                    <VerticalStackLayout Spacing="6">
                        <Label Text="Pilih Batch (berdasarkan kadaluarsa)" FontAttributes="Bold" TextColor="{StaticResource TextPrimary}"/>
                        <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="10,0" HasShadow="False">
                            <Picker x:Name="BatchPicker" Title="Otomatis (FIFO)" SelectedIndexChanged="OnBatchChanged" />
                        </Frame>
                    </VerticalStackLayout>

                    <VerticalStackLayout Spacing="6">
                        <Label Text="Jumlah" FontAttributes="Bold" TextColor="{StaticResource TextPrimary}"/>
                        <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="10">
                            <Button Grid.Column="0" Text="-" BackgroundColor="{StaticResource Gray200}" TextColor="{StaticResource TextPrimary}" WidthRequest="44" HeightRequest="44" CornerRadius="10" Clicked="OnDecreaseQty" />
                            <Frame Grid.Column="1" BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Entry x:Name="QtyEntry" Text="1" Keyboard="Numeric" HorizontalTextAlignment="Center" TextChanged="OnQtyChanged" />
                            </Frame>
                            <Button Grid.Column="2" Text="+" BackgroundColor="{StaticResource Gray200}" TextColor="{StaticResource TextPrimary}" WidthRequest="44" HeightRequest="44" CornerRadius="10" Clicked="OnIncreaseQty" />
                        </Grid>
                    </VerticalStackLayout>

                    <VerticalStackLayout Spacing="6">
                        <Label Text="Metode Pembayaran" FontAttributes="Bold" TextColor="{StaticResource TextPrimary}"/>
                        <StackLayout Orientation="Horizontal" Spacing="20">
                            <RadioButton x:Name="CashRadio" Content="ðŸ’µ Tunai" IsChecked="True" />
                            <RadioButton x:Name="QrisRadio" Content="ðŸ“± QRIS" />
                        </StackLayout>
                    </VerticalStackLayout>

                    <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="12" Padding="12" HasShadow="False">
                        <Grid ColumnDefinitions="*,Auto">
                            <Label Text="Total" FontAttributes="Bold" TextColor="{StaticResource TextPrimary}" />
                            <Label x:Name="TotalLabel" Grid.Column="1" Text="Rp 0" FontAttributes="Bold" TextColor="{StaticResource Primary}" />
                        </Grid>
                    </Frame>

                    <Label x:Name="ErrorLabel" TextColor="{StaticResource Danger}" FontSize="12" IsVisible="False" />

                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,6,0,0">
                        <Button Grid.Column="0"
                                Text="Cancel"
                                BackgroundColor="{StaticResource Gray200}"
                                TextColor="{StaticResource TextPrimary}"
                                CornerRadius="10"
                                HeightRequest="44"
                                Clicked="OnCancelClicked" />

                        <Button x:Name="ConfirmButton"
                                Grid.Column="1"
                                Text="Konfirmasi"
                                BackgroundColor="{StaticResource Primary}"
                                TextColor="White"
                                CornerRadius="10"
                                HeightRequest="44"
                                Clicked="OnConfirmClicked" />
                    </Grid>
                </VerticalStackLayout>
            </ScrollView>

        </Frame>
    </Grid>
</ContentPage>
